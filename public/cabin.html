<html>
  <head>
    <meta charset="utf-8" />
    <title>Cozy Cabin</title>
    <meta name="description" content="Cozy Cabin" />

    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.4.0/socket.io.slim.js"></script>
    <script src="/easyrtc/easyrtc.js"></script>
    <script src="https://unpkg.com/networked-aframe@^0.9.0/dist/networked-aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component/dist/aframe-environment-component.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@5.0.0/dist/aframe-event-set-component.min.js"></script>
    <script src="https://unpkg.com/aframe-proxy-event-component/dist/aframe-proxy-event-component.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script src="/js/joystick.min.js"></script>
    
     <script>
      // see issue https://github.com/networked-aframe/networked-aframe/issues/267
      NAF.schemas.getComponentsOriginal = NAF.schemas.getComponents;
      NAF.schemas.getComponents = (template) => {
        if (!NAF.schemas.hasTemplate("#avatar-template")) {
          NAF.schemas.add({
            template: '#avatar-template',
            components: [
              'position',
              'rotation',
              {
                selector: '.head',
                component: 'material',
                property: 'color'
              }
            ]
          });
        }
        const components = NAF.schemas.getComponentsOriginal(template);
        return components;
      }
    </script>
    <script src="https://unpkg.com/aframe-randomizer-components@^3.0.1/dist/aframe-randomizer-components.min.js"></script>
    <script src="/js/spawn-in-circle.component.js"></script>
    <link rel="stylesheet" type="text/css" href="/style.css" />
    
    </head>
  <body>
    <a-scene joystick networked-scene="
      room: basic-audio;
      debug: true;
      adapter: easyrtc;
      audio: false;">
    
    <a-assets>
      <a-asset-item id="mountain" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/Snow%20Environment.glb?v=1650122794907"></a-asset-item>
      <a-asset-item id="tree1" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/Tree%201.glb?v=1650122795476"></a-asset-item>
      <a-asset-item id="tree2" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/Tree%202.glb?v=1650122797745"></a-asset-item>
      <a-asset-item id="tree3" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/Tree%204.glb?v=1650122800494"></a-asset-item>
      <a-img id="wood" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/thumbnails_TexturesCom_Wood_RusticVeneer_512_albedo.jpg?v=1650122641567"/>
      <a-img id="woodnm" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/thumbnails_NormalMap%20wood.jpg?v=1650122640763"/>
      <a-img id="door" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/thumbnails_TexturesCom_WoodOldRough3_512_albedo.jpg?v=1650122641839"/>
      <a-img id="doornm" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/thumbnails_NormalMap%20door.jpg?v=1650122640858"/>
      <a-asset-item id="snowman" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/Snowman.glb?v=1650122803616"></a-asset-item>  
      <a-asset-item id="fireplace" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/Fireplace.glb?v=1650122811250"></a-asset-item>
      <a-asset-item id="bearhead" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/Bear%20Head.glb?v=1650122813146"></a-asset-item>
      <audio id="fire" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/fire.mp3?v=1650123621005" preload="auto"></audio>
      <a-asset-item id="rchair" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/rchair.glb?v=1650122818483"></a-asset-item>
      <a-asset-item id= "bluebed" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/bed_blue.glb?v=1650122820345"></a-asset-item>
      <a-asset-item id="house" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/Wood%20Cabin.glb?v=1650127211453"></a-asset-item>
      <img id="fur" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/Stylized_Fur_001_basecolor.jpg?v=1650177615179"/>
      <img id="furnormal" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/Stylized_Fur_001_normal.jpg?v=1650177541369"/>
      <img id="furrough" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/Stylized_Fur_001_roughness.jpg?v=1650177811015"/>
      
       <!--links and thumbs-->
        <img id="beach" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/screenshot-sunset%20beach-1650178362899-min.png?v=1650178805133">
        <img id="cabin" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/screenshot-cozy%20cabin-1650178645818-min.png?v=1650178802795">
        <img id="picnic" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/screenshot-pink%20picnic-1650178233032-min.png?v=1650178800354">
        <img id="TherapyRoom" src="https://cdn.glitch.global/87012bd5-a4bf-45cf-80ee-67e5ced56e30/screenshot-theravr%20therapy%20room-1650178327951-min.png?v=1650178800592">
      
       <!-- Templates -->

        <!-- Avatar -->
         <template id="avatar-template">
           
          <a-entity class="avatar" networked-audio-source>
            <a-sphere class="head" 
              scale="0.3 0.3 0.3"></a-sphere>
            
            <a-entity class="face"
              position="0 0.05 0">
              
              <a-sphere class="eye" 
                  color="#efefef" 
                  position="-0.10514 0 -0.224" 
                  scale="0.08 0.08 0.08">
                <a-sphere class="pupil" 
                  color="#000" 
                  position="0 0 -0.874" 
                  scale="0.2 0.2 0.2" ></a-sphere>
              </a-sphere>
              
              <a-sphere class="eye" 
                  color="#efefef" 
                  position="0.10514 0 -0.224" 
                  scale="0.08 0.08 0.08">
                <a-sphere class="pupil" 
                  color="#000" 
                  position="0 0 -.874" 
                  scale="0.2 0.2 0.2" ></a-sphere>
              </a-sphere>
            </a-entity>
            
           <a-cone class="body" 
              geometry="segmentsHeight: 8; segmentsRadial: 8"
              rotation="180 0 0" 
              position="0 -0.72 0"
              scale="0.35 0.8 0.35">
            
             <a-sphere class="arm" 
                scale="0.23 0.37 0.24"
                position="-1.094 -0.111 0"
                rotation="0 0 14"></a-sphere>
             
             <a-sphere class="arm" 
                scale="0.23 0.37 0.24"
                position="1.094 -0.111 0"
                rotation="0 0 -14"></a-sphere>
            </a-cone>
          </a-entity>
        </template>
      
    </a-assets>
    
    <!--SCENE-->
      <!--player entity-->
      <a-entity id="player"
                camera
                networked="template:#avatar-template;attachTemplateToLocal:false;"
                position="0 1.6 -8.657"
                spawn-in-circle="radius:2"
                wasd-controls
                look-controls>
         <a-entity cursor
                  position="0 0 -1"
                  geometry="primitive: sphere; radius: 0.008;"
                  material="color: beige; shader:flat; opacity:0.8"
                  animation__click="property:scale;
                                    startEvents: click;
                                    easing: ;
                                    dur: 150;
                                    from: 0.1 0.1 0.1; to: 1 1 1;"
                  animation__fusing="property: scale; 
                                     startEvents: fusing; 
                                     easing: easeInCubic; 
                                     dur: 1500; 
                                     from: 1 1 1; to: 3 3 3">
        </a-entity>
        <a-sphere class="head"
          visible="false"
          random-color
        ></a-sphere>
      </a-entity>
      
      <!-- Environment -->
      <a-entity environment="preset: default; skyType: atmosphere; groundTexture: squares; groundColor:#ededed ; groundColor2:#2a3610; lighting:none; lightPosition:0 -1 2; playArea: 0.95;
                             dressing:trees; dressingAmount:1; dressingColor:#446f1a; dressingScale:1 ; dressingVariance: 1 0.5 1;" position="0 -0.1 0 "></a-entity>
      
      <a-entity gltf-model="#mountain" position="-180 -1 -250" scale="0.7 0.7 0.7"></a-entity>
      
      <!--light-->
      <a-entity light="type: ambient; intensity:0.26"></a-entity>
      <a-entity light="type: directional; intensity:1" position="0 3 0"></a-entity>
       <!-- light 1-->
      <a-entity position="0 1.41613 -9.9135" visible="">
       <a-cylinder color="black"  radius="0.02" position="0 1.58117 0" geometry="height: 0.75">
         <a-dodecahedron radius=".07" position="0 -0.39355 0" material="color: #ccd733; opacity: 0.62">
           <a-entity light="type: point; intensity: 0.46; angle: 80; color: #ccd733; decay: 1.62; distance: 6.88;"  ></a-entity>
         </a-dodecahedron>
       </a-cylinder>
      </a-entity>
      
      <!--links full-->
      <!--link 1 beach-->
      <a-entity>
      <a-entity position="4.77591 1.7 -9.58252" rotation="0 -90 0"
                event-set__mouseenter="scale: 1.15 1.15 1" event-set__mouseleave="scale: 1 1 1">
        <!--border-->
        <a-entity id="border" geometry="primitive: plane" scale="1.25 0.85 1" material="color:#ce8d8d"
                  event-set__mouseenter="material.color:#e60000;" event-set__mouseleave="material.color:#ce8d8d"></a-entity>
        <!--link-->
        <a-entity id="linkToBeach" geometry="primitive: plane" link="href: beach.html; image: #beach" 
                  material="shader: portal; side: double; pano: #beach" 
                  position="0 0 0.01" 
                  scale="1.2 .8 1"
                  event-set__mouseenter="material.color:#e60000; _target:#border" event-set__mouseleave="material.color:#ce8d8d; _target:#border">
        </a-entity>
        <a-entity position="0 -0.55 0" text="align: center; color: #a8a8a8; font: roboto; value: beach; width: 5" scale="0.75 0.75 1">
          <a-entity id="textborder" geometry="primitive: plane; height:0.24; width:0.64;" scale="" material="color:#000000"></a-entity>
        </a-entity>
      </a-entity>
      
      <!--link 2 index-->
      <a-entity position="4.77591 1.7 -11.58252" rotation="0 -90 0"
                event-set__mouseenter="scale: 1.15 1.15 1" event-set__mouseleave="scale: 1 1 1">
        <!--border-->
        <a-entity id="border2" geometry="primitive: plane" scale="1.25 0.85 1" material="color:##ffffff"
                  event-set__mouseenter="material.color:#00ff2a;" event-set__mouseleave="material.color:#ffffff"></a-entity>
        <!--link-->
        <a-entity id="linkToTR" geometry="primitive: plane" link="href: index.html; image: #TherapyRoom" 
                  material="shader: portal; side: double; pano: #TherapyRoom" 
                  position="0 0 0.01" 
                  scale="1.2 .8 1"
                  event-set__mouseenter="material.color:#00ff2a; _target:#border2" event-set__mouseleave="material.color:#ffffff; _target:#border2">
        </a-entity>
        <a-entity position="0 -0.55 0" text="align: center; color: #a8a8a8; font: roboto; value: Therapy Room; width: 5" scale="0.75 0.75 1">
          <a-entity id="textborder2" geometry="primitive: plane; height:0.24; width:1.5;" position="0 -0.02 0" material="color:#000000"></a-entity>
        </a-entity>
      </a-entity>
      
      <!--link 3 picnic-->   
      <a-entity position="4.77591 1.7 -7.58252" rotation="0 -90 0"
                event-set__mouseenter="scale: 1.15 1.15 1" event-set__mouseleave="scale: 1 1 1">
        <!--border-->
        <a-entity id="border3" geometry="primitive: plane" scale="1.25 0.85 1" material="color:#FF69B4"
                  event-set__mouseenter="material.color:#00fbff;" event-set__mouseleave="material.color:#FF69B4"></a-entity>
        <!--link-->
        <a-entity id="linkToPicnic" geometry="primitive: plane" link="href: picnic.html; image: #picnic" 
                  material="shader: portal; side: double; pano: #picnic" 
                  position="0 0 0.01" 
                  scale="1.2 .8 1"
                  event-set__mouseenter="material.color:#00fbff; _target:#border3" event-set__mouseleave="material.color:#FF69B4; _target:#border3">
        </a-entity>
        <a-entity position="0 -0.55 0" text="align: center; color: #a8a8a8; font: roboto; value: picnic; width: 5" scale="0.75 0.75 1">
          <a-entity id="textborder3" geometry="primitive: plane; height:0.22; width:0.6;" position="0 -0.02 0" material="color:#000000"></a-entity>
        </a-entity>
      </a-entity>
        
      </a-entity>
      
      <!-- Outside Decoration -->
  <!--    <a-entity gltf-model="#" position="" scale=""></a-entity> -->
      <a-entity gltf-model="#tree1" position="-10 0 -8" scale="1 1 1"></a-entity>
      <a-entity gltf-model="#tree2" position="-13 -0.15 -20" scale="1 1 1"></a-entity>
      <a-entity gltf-model="#tree3" position="25 0 5" scale="0.01 0.01 0.01"></a-entity>
      <a-entity gltf-model="#tree1" position="3 0 7" scale="1 1 1"></a-entity>
      <a-entity gltf-model="#tree2" position="0 -0.15 -3" scale="1 1 1"></a-entity>
      <a-entity gltf-model="#tree3" position="14 0 30" scale="0.01 0.01 0.01"></a-entity>
      <a-entity gltf-model="#snowman" position="10 0 -10" rotation="0 -135 0" scale="2 2 2"></a-entity>
      
      
      
      <!-- House -->
      <a-entity gltf-model="#house" position="0 0 0">
        
      <a-entity geometry="primitive: plane; height: 5.12; width: 4" rotation="-90 20 0" position="-1.91502 0.01 -8.17314"
                material="src:#fur;
                          normalMap:#furnormal;
                          repeat:5 5;
                          normalTextureRepeat:5 5;
                          roughness:0.7;"></a-entity>
        
      <!--guide-->
      
      <!--instructions-->
        <a-entity geometry="primitive: plane; height: 1.2; width: 1.69" rotation="" material="color: #990000; side: double" position="-3.00363 1.8 -14" scale="1 1 0.05" look-at="#player">
            <a-entity position="0 0.45168 0.01693" text="align: center; color: #e0d8e8; value: Cozy Cabin; width: 5.07"></a-entity>
            <a-entity position="0.00012 0.19693 0.02043" text="align: center; color: #e0d8e8; value: come sit by the fireplace                                          and hear it crackle; width: 2.31"></a-entity>
            <a-entity position="0 -0.08307 0.03636" text="align: center; color: #e0d8e8; value: look/click at the paintings                                                       to traverse to a peaceful environment; width: 2.31; wrapCount: 45.35"></a-entity>
            <a-entity position="0 -0.37351 0.09321" text="align: center; color: #e0d8e8; value: We hope you find the peace                                                       you have been looking for; width: 2.6"></a-entity>
        </a-entity>
       
      <a-box position="-5 2 -10" width="0.1" height="1.6" depth="6" opacity="0.5" color="white"></a-box>
      
      <!--door-->
      <a-box position="-3 1.5 -5" height="3" depth="0.1" width="2" material="src:#door; normal-map:#doornm;">
      <a-cylinder position="0.8 -0.15 0" rotation="90 0 0" radius="0.03" height="0.2" color="grey"></a-cylinder>
      <a-sphere position="0.8 -0.15 0.15" radius="0.06" color="grey"></a-sphere>
      <a-sphere position="0.8 -0.15 -0.15" radius="0.06" color="grey"></a-sphere>
      </a-box>
      
      <a-plane position="0 0 -10" rotation="-90 90 0" height="10" width="10" material="src:#door; normalMap:#doornm; roughness:0.8"></a-plane> 
        
      <a-entity gltf-model="#fireplace" position="0 0 -14.5" scale="0.3 0.3 0.3"> 
            <a-entity light="type: point; color: #e45858; decay: 1.87; distance: 9.63" position="0 2.5 0"></a-entity>
            <a-entity position="0 2.5 0" sound="src: #fire; autoplay:true; loop:true; volume:2;"></a-entity>
      </a-entity>  
      
      <a-entity gltf-model="#bearhead" rotation="0 180 0" position="0.078 2.6 -14.6" scale="0.33 0.33 0.33"></a-entity> 
       
      <a-entity gltf-model="#rchair" position="-2 0 -12" rotation="0 135 0" scale="1.3 1.3 1.3"></a-entity>
      <a-entity gltf-model="#rchair" position="2 0 -12" rotation="0 -135 0" scale="1.3 1.3 1.3"></a-entity> 
        
      <a-entity gltf-model="#bluebed" position="3.44653 0 -7.27671" rotation="0 180 0" scale="0.008 0.008 0.008"></a-entity>
        
      </a-entity>
    
    
    </a-scene>
  </body>
</html>
             
